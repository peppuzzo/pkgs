# vim: set ft=sh:
pkgname=slepc
pkgver=3.6.2
pkgurl=http://www.grycap.upv.es/slepc/download/distrib/slepc-$pkgver.tar.gz

unset SLEPC_DIR
module load petsc
module load arpack-ng

configure()
{
  pushd $tmpdir/$srcdir
  ./configure \
    --prefix=$destdir \
    --download-blopex \
    --with-arpack=1 \
    --with-arpack-dir=$ARPACK_DIR/lib
}

build()
{
  pushd $tmpdir/$srcdir
  make SLEPC_DIR=$PWD
  popd
}

package()
{
  pushd $tmpdir/$srcdir
  # install new one
  make SLEPC_DIR=$tmpdir/$srcdir install
  popd
}

pkgmodule=$(cat <<-EOT
#%Module
module load petsc
module load arpack-ng

set SLEPC_DIR $REPO/opt/slepc-$pkgver
setenv SLEPC_DIR \$SLEPC_DIR

prepend-path PATH \$SLEPC_DIR/bin
prepend-path PKG_CONFIG_PATH \$SLEPC_DIR/lib/pkgconfig
EOT)
